namespace SpriteKind {
    export const Smallenemy = SpriteKind.create()
    export const Powerup = SpriteKind.create()
    export const Prox = SpriteKind.create()
}
sprites.onOverlap(SpriteKind.Player, SpriteKind.Powerup, function (sprite, otherSprite) {
    otherSprite.destroy(effects.confetti, 500)
    info.changeLifeBy(1)
})
function rotatePlayer (playerSprite: Sprite, direction: number) {
    transformSprites.changeRotation(playerSprite, direction)
}
controller.up.onEvent(ControllerButtonEvent.Pressed, function () {
    A(Ship)
})
function A (mySprite: Sprite) {
    // Zero rotation represents north; adjust to correct polar angle.
    thrustDir = transformSprites.getRotation(mySprite) - 90
    thrustDirRads = thrustDir * 3.1416 / 180
    thrustX = THRUSTER_VELOCITY * Math.cos(thrustDirRads)
    thrustY = THRUSTER_VELOCITY * Math.sin(thrustDirRads)
    mySprite.vx += thrustX
    mySprite.vy += thrustY
    mySprite.startEffect(effects.fire, 500)
}
controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
    Ship.setPosition(randint(0, 160), randint(0, 120))
    transformSprites.changeRotation(Ship, randint(-360, 360))
})
sprites.onOverlap(SpriteKind.Smallenemy, SpriteKind.Prox, function (sprite, otherSprite) {
    music.sonar.play()
})
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    fireTorpedo(Ship)
})
sprites.onOverlap(SpriteKind.Enemy, SpriteKind.Prox, function (sprite, otherSprite) {
    music.sonar.play()
})
controller.left.onEvent(ControllerButtonEvent.Pressed, function () {
    rotatePlayer(Ship, -30)
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Enemy, function (sprite2, otherSprite2) {
    sprite2.startEffect(effects.ashes, 500)
    otherSprite2.destroy(effects.disintegrate, 500)
    scene.cameraShake(8, 500)
    info.changeLifeBy(-1)
    music.bigCrash.play()
    pause(1000)
})
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Smallenemy, function (sprite, otherSprite) {
    list += -50
    sprite.destroy(effects.fire, 500)
    otherSprite.destroy(effects.disintegrate, 500)
    info.changeScoreBy(1)
})
controller.right.onEvent(ControllerButtonEvent.Pressed, function () {
    rotatePlayer(Ship, 30)
})
controller.down.onEvent(ControllerButtonEvent.Pressed, function () {
    Ship.setVelocity(0, 0)
})
info.onLifeZero(function () {
    game.over(false, effects.melt)
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Food, function (sprite, otherSprite) {
    otherSprite.destroy(effects.confetti, 500)
    statusbar.value += 50
    music.powerUp.play()
})
function fireTorpedo (playerSprite2: Sprite) {
    if (statusbar.value > 1) {
        // 0 degrees is north; adjust to correct polar angle.
        torpedoDir = transformSprites.getRotation(playerSprite2) - 90
        torpedoDirRads = torpedoDir * (3.1416 / 180)
        torpedoVx = TORPEDO_SPEED * Math.cos(torpedoDirRads)
        torpedoVy = TORPEDO_SPEED * Math.sin(torpedoDirRads)
        // Give the torpedo a head start so the player doesn't blow up. :-)
        torpedoDx = 16 * Math.cos(torpedoDirRads)
        torpedoDy = 16 * Math.sin(torpedoDirRads)
        projectile = sprites.createProjectileFromSprite(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . 7 . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            `, playerSprite2, torpedoVx, torpedoVy)
        music.zapped.play()
        statusbar.value += -1
    }
}
sprites.onOverlap(SpriteKind.Smallenemy, SpriteKind.Player, function (sprite, otherSprite) {
    scene.cameraShake(8, 500)
    sprite.destroy(effects.disintegrate, 500)
    otherSprite.startEffect(effects.ashes, 500)
    info.changeLifeBy(-1)
    music.bigCrash.play()
    pause(1000)
})
function Boom (mySprite2: Sprite) {
    projectile3 = sprites.createProjectileFromSprite(Small_asteroids[randint(0, Small_asteroids.length - 1)], mySprite2, randint(-50, 50), randint(-50, 50))
    projectile3.setKind(SpriteKind.Smallenemy)
    projectile4 = sprites.createProjectileFromSprite(Small_asteroids[randint(0, Small_asteroids.length - 1)], mySprite2, randint(-50, 50), randint(-50, 50))
    projectile4.setKind(SpriteKind.Smallenemy)
    projectile5 = sprites.createProjectileFromSprite(Small_asteroids[randint(0, Small_asteroids.length - 1)], mySprite2, randint(-50, 50), randint(-50, 50))
    projectile5.setKind(SpriteKind.Smallenemy)
}
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Enemy, function (sprite, otherSprite) {
    Level += -50
    Boom(otherSprite)
    sprite.destroy(effects.fire, 500)
    info.changeScoreBy(1)
    if (Math.percentChance(30)) {
        Boom(otherSprite)
    }
    otherSprite.destroy(effects.disintegrate, 500)
})
let HP: Sprite = null
let Powerup2: Sprite = null
let projectile2: Sprite = null
let projectile5: Sprite = null
let projectile4: Sprite = null
let projectile3: Sprite = null
let projectile: Sprite = null
let torpedoDy = 0
let torpedoDx = 0
let torpedoVy = 0
let torpedoVx = 0
let torpedoDirRads = 0
let torpedoDir = 0
let list = 0
let thrustY = 0
let thrustX = 0
let thrustDirRads = 0
let thrustDir = 0
let TORPEDO_SPEED = 0
let THRUSTER_VELOCITY = 0
let Small_asteroids: Image[] = []
let statusbar: StatusBarSprite = null
let Ship: Sprite = null
effects.starField.startScreenEffect()
Ship = sprites.create(img`
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . 7 . . . . . . . 
    . . . . . . . . 2 . . . . . . . 
    . . . . . . . 2 2 2 . . . . . . 
    . . . . . . . 2 2 2 . . . . . . 
    . . . . . . 2 2 2 2 2 . . . . . 
    . . . . . 2 2 2 2 2 2 2 . . . . 
    `, SpriteKind.Player)
statusbar = statusbars.create(160, 6, StatusBarKind.Energy)
statusbar.positionDirection(CollisionDirection.Bottom)
statusbar.setColor(7, 2)
statusbar.value = 50
statusbar.setPosition(80, 0)
let Prox2 = sprites.create(img`
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    .............................................................22222222222222222..................................................................................
    .............................................................222222222222222222222222...........................................................................
    .............................................................22222222222222222222222222.........................................................................
    .............................................................2222222222222222222222222222.......................................................................
    ............................................................222222222222222222222222222222......................................................................
    ...........................................................22222222222222222222222222222222.....................................................................
    ...........................................................222222222222222222222222222222222....................................................................
    ..........................................................22222222222222222222222222222222222...................................................................
    .........................................................222222222222222222222222222222222222...................................................................
    .........................................................2222222222222222222222222222222222222..................................................................
    .........................................................2222222222222222222222222222222222222..................................................................
    .........................................................22222222222222222222222222222222222222.................................................................
    .........................................................22222222222222222222222222222222222222.................................................................
    .........................................................22222222222222222222222222222222222222.................................................................
    .........................................................222222222222222222222222.2222222222222.................................................................
    ..........................................................2222222222222222222222222222222222222.................................................................
    ........................................................222222222222222222222222222222222222222.................................................................
    ........................................................222222222222222222222222222222222222222.................................................................
    ........................................................222222222222222222222222222222222222222.................................................................
    ........................................................222222222222222222222222222222222222222.................................................................
    ........................................................222222222222222222222222222222222222222.................................................................
    ........................................................222222222222222222222222222222222222222.................................................................
    ........................................................222222222222222222222222222222222222222.................................................................
    ........................................................222222222222222222222222222222222222222.................................................................
    ........................................................2222222222222222222222222222222.2222222.................................................................
    ........................................................222222222222222222222222222222222222222.................................................................
    ........................................................22222222222222222222222222222222222222..................................................................
    ........................................................22222222222222222222222222222222222222..................................................................
    ........................................................2222222222222222222222222222222222222...................................................................
    ........................................................2222222222222222222222222222222222222...................................................................
    ........................................................2222222222222222222222222222222222222...................................................................
    .........................................................222222222222222222222222222222222222...................................................................
    ..........................................................2222222222222222222..22222222222222...................................................................
    ...........................................................2222222222222222222.22222222.22222...................................................................
    ...........................................................222222222222222222222222222..........................................................................
    ..............................................................2222222222222222222222............................................................................
    ....................................................................22222222222222..............................................................................
    .....................................................................22222222222................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    `, SpriteKind.Prox)
Prox2.setFlag(SpriteFlag.Invisible, true)
Prox2.follow(Ship)
let Big_asteroids = [
img`
    . . . . . . . . . c c 8 . . . . 
    . . . . . . 8 c c c f 8 c c . . 
    . . . c c 8 8 f c a f f f c c . 
    . . c c c f f f c a a f f c c c 
    8 c c c f f f f c c a a c 8 c c 
    c c c b f f f 8 a c c a a a c c 
    c a a b b 8 a b c c c c c c c c 
    a f c a a b b a c c c c c f f c 
    a 8 f c a a c c a c a c f f f c 
    c a 8 a a c c c c a a f f f 8 a 
    . a c a a c f f a a b 8 f f c a 
    . . c c b a f f f a b b c c 6 c 
    . . . c b b a f f 6 6 a b 6 c . 
    . . . c c b b b 6 6 a c c c c . 
    . . . . c c a b b c c c . . . . 
    . . . . . c c c c c c . . . . . 
    `,
img`
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . c c c c . . 
    . c c c c c . c c c c c f c c . 
    c c a c c c c c 8 f f c f f c c 
    c a f a a c c a f f c a a f f c 
    c a 8 f a a c a c c c a a a a c 
    c b c f a a a a a c c c c c c c 
    c b b a a c f 8 a c c c 8 c c c 
    . c b b a b c f a a a 8 8 c c . 
    . . . . a a b b b a a 8 a c . . 
    . . . . c b c a a c c b . . . . 
    . . . . b b c c a b b a . . . . 
    . . . . b b a b a 6 a . . . . . 
    . . . . c b b b 6 6 c . . . . . 
    . . . . . c a 6 6 b c . . . . . 
    . . . . . . . c c c . . . . . . 
    `,
img`
    . . . . . . . . c c c c . . . . 
    . . . . c c c c c c c c c . . . 
    . . . c f c c a a a a c a c . . 
    . . c c f f f f a a a c a a c . 
    . . c c a f f c a a f f f a a c 
    . . c c a a a a b c f f f a a c 
    . c c c c a c c b a f c a a c c 
    c a f f c c c a b b 6 b b b c c 
    c a f f f f c c c 6 b b b a a c 
    c a a c f f c a 6 6 b b b a a c 
    c c b a a a a b 6 b b a b b a . 
    . c c b b b b b b b a c c b a . 
    . . c c c b c c c b a a b c . . 
    . . . . c b a c c b b b c . . . 
    . . . . c b b a a 6 b c . . . . 
    . . . . . . b 6 6 c c . . . . . 
    `,
img`
    . . . . . . c c c . . . . . . . 
    . . . . . a a a c c c . . . . . 
    . . . c a c f a a a a c . . . . 
    . . c a c f f f a f f a c . . . 
    . c c a c c f a a c f f a c . . 
    . a b a a c 6 a a c c f a c c c 
    . a b b b 6 a b b a a c a f f c 
    . . a b b a f f b b a a c f f c 
    c . a a a c c f c b a a c f a c 
    c c a a a c c a a a b b a c a c 
    a c a b b a a 6 a b b 6 b b c . 
    b a c b b b 6 b c . c c a c . . 
    b a c c a b b a c . . . . . . . 
    b b a c a b a a . . . . . . . . 
    a b 6 b b a c . . . . . . . . . 
    . a a b c . . . . . . . . . . . 
    `
]
Small_asteroids = [
img`
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . c c c . . . . . . 
    . . . . . . a b a a . . . . . . 
    . . . . . c b a f c a c . . . . 
    . . . . c b b b f f a c c . . . 
    . . . . b b f a b b a a c . . . 
    . . . . c b f f b a f c a . . . 
    . . . . . c a a c b b a . . . . 
    . . . . . . c c c c . . . . . . 
    . . . . . . . c . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    `,
img`
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . c c . . . . . . 
    . . . . . c a a a a . . . . . . 
    . . . . . a a f f b a . . . . . 
    . . . . c a b f f c b . . . . . 
    . . . . c b b b a f c b . . . . 
    . . . . c b a c a b b b . . . . 
    . . . . . b b f f a a c . . . . 
    . . . . . . a a b b c . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    `,
img`
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . c c . . . . . . . 
    . . . . c a a a a . . . . . . . 
    . . . . a a f f b a . . . . . . 
    . . . c a b f f c b . . . . . . 
    . . . c b b b a f c b . . . . . 
    . . . c b a c a b b b . . . . . 
    . . . . b b f f a a c . . . . . 
    . . . . . a a b b c . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    `,
img`
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . c . . . . . . . . 
    . . . . c a a a c . . . . . . . 
    . . . c c f a b b c . . . . . . 
    . . . b f f b f a a . . . . . . 
    . . . b b a b f f a . . . . . . 
    . . . c b f b b a c . . . . . . 
    . . . . b a f c c . . . . . . . 
    . . . . . b b c . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    `,
img`
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . c b a c . . . . . . 
    . . . . c c b c f a c . . . . . 
    . . . . a f b b b a c . . . . . 
    . . . . a f f b a f c c . . . . 
    . . . . c b b a f f c . . . . . 
    . . . . . b b a f a . . . . . . 
    . . . . . . c b b . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    `,
img`
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . c c . . . . . . . . 
    . . . . c a f b c . . . . . . . 
    . . . . b f f b c c . . . . . . 
    . . . a a f b a b a c . . . . . 
    . . . c a c b b f f b . . . . . 
    . . . . b f f b f a b . . . . . 
    . . . . a f f b b b a . . . . . 
    . . . . . a b b c c . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    . . . . . . . . . . . . . . . . 
    `
]
THRUSTER_VELOCITY = 5
TORPEDO_SPEED = 100
let Level = 1700
info.setLife(5)
game.onUpdateInterval(Level, function () {
    projectile2 = sprites.createProjectileFromSide(Big_asteroids[randint(0, Big_asteroids.length - 1)], randint(-50, 50), randint(-50, 50))
    projectile2.setKind(SpriteKind.Enemy)
})
forever(function () {
    if (Ship.x < 0 || Ship.x > 160) {
        if (Ship.x < 50) {
            Ship.x = 160
        } else {
            Ship.x = 0
        }
    }
    if (Ship.y < 0 || Ship.y > 120) {
        if (Ship.y < 50) {
            Ship.y = 120
        } else {
            Ship.y = 0
        }
    }
    music.playMelody("E E F - F D A C ", 120)
})
game.onUpdateInterval(10000, function () {
    if (Math.percentChance(50)) {
        Powerup2 = sprites.createProjectileFromSide(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . d d d d d d d d d d . . . 
            . . . d 7 7 7 7 7 7 7 7 d . . . 
            . . d 7 7 7 7 7 7 7 7 7 7 d . . 
            . . d 7 7 7 7 7 7 7 7 7 7 d . . 
            . . . d 7 7 7 7 7 7 7 7 d . . . 
            . . . d d d d d d d d d d . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            `, randint(-10, 10), randint(-10, 10))
        Powerup2.setKind(SpriteKind.Food)
    } else {
        HP = sprites.createProjectileFromSide(img`
            ....................
            ....................
            ....................
            ....................
            ....................
            ......22....22......
            .....2222..2222.....
            .....2222222222.....
            .....2222222222.....
            .....2222222222.....
            ......22222222......
            .......222222.......
            .......222222.......
            ........2222........
            .........22.........
            ....................
            ....................
            ....................
            ....................
            ....................
            `, randint(-30, 30), randint(-30, 30))
        HP.setKind(SpriteKind.Powerup)
    }
})
